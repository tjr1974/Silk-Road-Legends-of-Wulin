<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Silk Road: Legends of Wulin</title>
  <link rel="icon" type="image/x-icon" href="source code/images/favicon/favicon.ico">
  <link rel="stylesheet" href="source code/css/login.css">
</head>
<body>
  <!-- Login container -->
  <div id="login-container">
    <div class="login-note">By what name do you wish to be known?</div>
    <input type="text" id="character-name" placeholder="Character Name" autocomplete="off">
    <input type="password" id="password" placeholder="Password">
    <button id="login-button">Login</button>
    <div class="login-note">or</div>
    <button id="create-new-character-button">Create New Character</button>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.js"></script>
  <script src="source code/javascript/server functions/shared socket connection.js"></script>
<script>
    // Login functions-----------------------------------------------------------------------
    const loginButton = document.getElementById('login-button');
    const passwordInput = document.getElementById('password');
    const characterNameInput = document.getElementById('character-name');
    loginButton.addEventListener('click', handleLogin);
    passwordInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        handleLogin();
      }
    });
    document.getElementById('create-new-character-button').addEventListener('click', () => {
      window.location.href = "source code/html/create new character.html";
    });
    function handleLogin() {
      const characterName = characterNameInput.value.trim();
      const password = passwordInput.value.trim();
      if (characterName && password) {
        console.log('Attempting login for:', characterName);
        socket.emit('login', { characterName, password });
      } else {
        alert('Please enter both character name and password.');
      }
    }
    function handleLoginResult(result) {
      console.log('Login result received:', result);
      if (result.success) {
        sessionStorage.setItem('playerName', result.playerName);
        console.log('Login successful, redirecting to client page...');
        window.location.href = "source code/html/client.html";
      } else {
        alert(result.message || 'Login failed. Please try again.');
      }
    }
    document.getElementById('create-new-character-button').addEventListener('click', () => {
      window.location.href = "source code/html/create new character.html";
    });
    window.addEventListener('load', () => {
      socket.on('loginResult', handleLoginResult);
      console.log('Login page loaded, socket connection established');
    });
  </script>
</body>
</html>